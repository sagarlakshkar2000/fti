# Turn off the rewrite engine first to clear any loops
RewriteEngine On

# 1. Base path - important for subfolder routing
RewriteBase /

# 2. Redirect root to /public if it's not already there
# This checks if the request is NOT already for the public folder
RewriteCond %{REQUEST_URI} !^/public/
RewriteRule ^(.*)$ public/$1 [L,QSA]

# 3. Inside the public folder, handle index.php routing
# If the file doesn't exist in /public, send it to /public/index.php
RewriteCond %{DOCUMENT_ROOT}/public/$1 !-f
RewriteCond %{DOCUMENT_ROOT}/public/$1 !-d
RewriteRule ^public/(.*)$ public/index.php [L,QSA]
